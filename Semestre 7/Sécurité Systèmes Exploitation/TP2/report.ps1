param (
    [string]$ComputerName
)

# Vérifier si le nom de l'ordinateur est fourni
if (-not $ComputerName) {
    Write-Host "Veuillez fournir le nom de l'ordinateur à interroger."
    exit
}

# Obtenir les informations sur l'ordinateur
try {
    # Obtenir l'état de la machine
    $status = (Get-Service -ComputerName $ComputerName -Name 'wuauserv').Status

    # Obtenir les informations du système d'exploitation
    $osInfo = Get-WmiObject -Class Win32_OperatingSystem -ComputerName $ComputerName

    # Obtenir les informations de la machine
    $computerInfo = Get-WmiObject -Class Win32_ComputerSystem -ComputerName $ComputerName

    # Obtenir l'adresse IP
    $networkInfo = Get-WmiObject -Class Win32_NetworkAdapterConfiguration -ComputerName $ComputerName | Where-Object { $_.IPEnabled -eq $true }
    $ipAddress = $networkInfo.IPAddress[0] # Prendre la première adresse IP

    # Obtenir l'adresse MAC
    $macAddress = $networkInfo.MACAddress

    # Vérifier si la machine est une VM
    $isVM = $computerInfo.Manufacturer -match "Microsoft Corporation" -or $computerInfo.Model -match "Virtual"

    # Obtenir la date de construction (DateBuilt) et le dernier temps de démarrage
    $dateBuilt = $computerInfo.InstallDate
    $lastBootTime = $osInfo.LastBootUpTime

    # Conversion des dates seulement si elles existent
    if ($dateBuilt) {
        $dateBuilt = [Management.ManagementDateTimeConverter]::ToDateTime($dateBuilt)
    } else {
        $dateBuilt = "N/A" # Ou une valeur par défaut
    }

    if ($lastBootTime) {
        $lastBootTime = [Management.ManagementDateTimeConverter]::ToDateTime($lastBootTime)
    } else {
        $lastBootTime = "N/A" # Ou une valeur par défaut
    }

    # Afficher le rapport en format de colonne
    Write-Host "Informations sur l'ordinateur $ComputerName`n"
    Write-Host "ComputerName      : $ComputerName"
    Write-Host "Status            : $status"
    Write-Host "OSVersion         : $($osInfo.Version)"
    Write-Host "OSCaption         : $($osInfo.Caption)"
    Write-Host "OSArchitecture    : $($osInfo.OSArchitecture)"
    Write-Host "IPAddress         : $ipAddress"
    Write-Host "MACAddress        : $macAddress"
    Write-Host "VM                : $(if ($isVM) { 'Oui' } else { 'Non' })"
    Write-Host "Model             : $($computerInfo.Model)"
    Write-Host "Manufacturer      : $($computerInfo.Manufacturer)"
    Write-Host "DateBuilt         : $dateBuilt"
    Write-Host "LastBootTime      : $lastBootTime"
}
catch {
    Write-Host "Une erreur s'est produite lors de la récupération des informations pour $ComputerName. Détails : $_"
}